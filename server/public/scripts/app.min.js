/*! duplexchicks 2016-05-06 */
var chickApp=angular.module("chickApp",["ngMaterial","ngMessages","ngRoute","googlechart"]);chickApp.config(["$routeProvider","$locationProvider",function(a,b){}]);var chickAppAdmin=angular.module("chickAppAdmin",["ngMaterial","ngMessages","ngRoute","md.data.table"]);chickAppAdmin.config(["$routeProvider","$locationProvider",function(a,b){a.when("/admin",{templateUrl:"/views/admin.html",controller:"AdminController"}).when("/emailList",{templateUrl:"/views/partials/emailList.html",controller:"EmailController"}).when("/setVariables",{templateUrl:"/views/partials/setVariables.html",controller:"SetVariablesController"}).otherwise({redirectTo:"/emailList"})}]),chickAppAdmin.controller("AdminController",["$scope","$http","$window","AdminService",function(a,b,c,d){a.toEmailList=function(){c.location.href="#emailList"},a.toDefaultValues=function(){c.location.href="#setVariables"}}]),chickAppAdmin.controller("EmailController",["$scope","$http","$window","AdminService","$mdDialog",function(a,b,c,d,e){"use strict";a.selected=[],a.limitOptions=[5,10,15],a.query={order:"date",limit:5,page:1},a.getContacts=function(){b.get("/submit").then(function(b){a.emailList=b.data,console.log(a.emailList),a.count=a.emailList.length})},a.getContacts(),a.toggleLimitOptions=function(){a.limitOptions=a.limitOptions?void 0:[5,10,15]},a.loadStuff=function(){a.promise=$timeout(function(){},2e3)},a.logItem=function(a){console.log(a.name,"was selected")},a.logOrder=function(a){console.log("order: ",a)},a.logPagination=function(a,b){console.log("page: ",a),console.log("limit: ",b)},a.changeStatus=function(a){console.log("Changing status of contact with id: ",a)},a.deleteContact=function(b){var c=e.confirm().title("Are you sure you want to delete this contact?").ok("Yes").cancel("No");e.show(c).then(function(){console.log("Yes"),d.deleteTheContact(b),a.getContacts()},function(){console.log("No")})},a.changeStatus=function(b){var c=e.confirm().title('Are you sure you want to mark contact as "Contacted"?').ok("Yes").cancel("No");e.show(c).then(function(){console.log("Yes"),d.updateTheContact(b),a.getContacts()},function(){console.log("No")})},a.changeStatusBack=function(b){var c=e.confirm().title('Are you sure you want to mark contact as "Not Contacted"?').ok("Yes").cancel("No");e.show(c).then(function(){console.log("Yes"),d.updateTheContactBack(b),a.getContacts()},function(){console.log("No")})}}]),chickAppAdmin.controller("SetVariablesController",["$scope","$http","$window","AdminService",function(a,b,c,d){a.getDefaults=function(){b.get("/defaults").then(function(b){a.defaultVariables=b.data[0],d.admin.defaults=a.defaultVariables})},a.getDefaults(),a.setDefaultValues=function(a){d.alterDefaults(a)}}]),chickApp.controller("InputController",["$scope","$log","$http","$window","$mdSidenav","$mdDialog","$mdMedia","ClientService",function(a,b,c,d,e,f,g,h){a.toggleMenu=function(){e("left").toggle()},a.inputData={},a.minMax={},a.getDefaults=function(){c.get("/defaults").then(function(b){defaultVariables=b.data[0],a.minMax=defaultVariables,a.inputData.monthlyRentPersonal=defaultVariables.monthlyRentPersonalDef,a.inputData.monthlyRentTenant=defaultVariables.monthlyRentTenantDef,a.inputData.targetPrice=defaultVariables.targetPriceDef,a.inputData.downPaymentPercentage=defaultVariables.downPaymentPercentageDef,a.inputData.mortgageRate=defaultVariables.mortgageRateDef,a.inputData.yearsAmmoritized=defaultVariables.yearsAmmoritizedDef,a.inputData.income=defaultVariables.incomeDef,a.inputData.mortgageYears=defaultVariables.mortgageYearsDef,a.inputData.vacancy=defaultVariables.vacancyDef,a.inputData.propertyTax=defaultVariables.propertyTaxDef,a.inputData.assocDues=defaultVariables.assocDuesDef,a.inputData.management=defaultVariables.managementDef,a.inputData.misc=defaultVariables.miscDef,a.inputData.insuranceAnnual=defaultVariables.insuranceAnnualDef,a.inputData.utils=defaultVariables.utilsDef,a.inputData.legalAccounting=defaultVariables.legalAccountingDef,a.inputData.taxBracket=defaultVariables.taxBracketDef,a.inputData.repairValue=defaultVariables.repairValueDef,a.inputData.years=defaultVariables.yearsDef,a.inputData.maritalStatus=!1,a.inputData.zipCode=defaultVariables.zipCode,a.inputData.appreciationRate=defaultVariables.appreciationRateDef,a.inputData.renterInsurance=defaultVariables.renterInsuranceDef})},a.getDefaults();a.$watchCollection("inputData",function(b,c){console.log(b,"newval");var d=function(){var a=b.targetPrice-b.targetPrice*b.downPaymentPercentage/100;return a},e=function(a){hold=b.mortgageRate/12/100*d();var c=Math.pow(1+b.mortgageRate/12/100,-1*a);return monthPay=hold/(1-c),monthPay},f=function(){var a=.006*b.targetPrice,c=100,d=b.propertyTax+a+b.utils+c+b.insuranceAnnual;return d/12},g=function(a){var c=d(),e=1+b.appreciationRate/12/100,f=a,g=c*Math.pow(e,f);return g-=d()},h=function(a){var c=a*b.targetPrice*(.05*.2);c>=.05*b.targetPrice&&(c=.05*b.targetPrice);var d=a*b.targetPrice*.0174;d>=.5*b.targetPrice&&(d=.5*b.targetPrice);var e=a*b.targetPrice*(.05*.2);e>=.2*b.targetPrice&&(e=.2*b.targetPrice);var f=e+d+c,f=f/12/2;return f},i=function(a){return rent=b.monthlyRentTenant*a,insurance=b.renterInsurance*a,rentTot=rent+insurance+b.utils*a,rentTot};console.log(i(12*b.years),"Test");var j=function(){var a=e(12*b.mortgageYears),c=f(),d=c+a;return d},k=function(){var a=f();return a},l=function(a){return downPayment=b.downPaymentPercentage/100*b.targetPrice,a<=12*b.mortgageYears?normalPay=j()*a:(firstPart=j()*b.mortgageYears*12,secondPart=(12*b.mortgageYears-a)*k(),normalPay=firstPart+secondPart),totalPay=normalPay+downPayment-g(a),totalPay},m=function(a){var b=l(a),c=h(a),d=b-c;return d};a.buy[1].v=l(12*b.years),a.rent[1].v=i(12*b.years),a.buyAndRent[1].v=m(12*b.years),a.buyValues=[],a.rentValues=[],a.buyAndRentValues=[],count=0;var n=function(){for(var c=0;c<12*b.years;c++)count++,a.buyValues.push(l(c)),a.buyAndRentValues.push(m(c)),a.rentValues.push(i(c))};n(),console.log(a.buyValues);var o=[],p=function(){for(var c=0;c<12*b.years;c++){var d={c:[{v:c},{v:a.buyValues[c]},{v:a.rentValues[c]},{v:a.buyAndRentValues[c]}]};o.push(d)}};p(),a.hiddenChartObject={type:"LineChart",data:{cols:[{id:"year",label:"Years",type:"string"},{id:"buy-line",label:"Buy",type:"number"},{id:"rent-line",label:"Rent",type:"number"},{id:"buyAndRent-line",label:"Buy & Rent-out",type:"number"}],rows:o},options:{title:"Long term Cost on Investment",isStacked:!0,fill:20,displayExactValues:!0,vAxis:{title:"Return",viewWindowMode:"explicit",viewWindow:{min:0}},hAxis:{title:"Years"},animation:{duration:300,easing:"out"}},formatters:{}}}),a.$watch.years=3,a.myChartObject={},a.myChartObject.type="ColumnChart",a.buy=[{v:"Buy"},{v:a.outputData},{v:"red"}],a.rent=[{v:"Rent"},{v:200},{v:"green"}],a.buyAndRent=[{v:"Buy & Rent-out"},{v:600},{v:"purple"}],a.myChartObject.data={cols:[{id:"options",label:"Options",type:"string"},{id:"dollars",label:"Dollars",type:"number"},{role:"style",type:"string"}],rows:[{c:a.buy},{c:a.rent},{c:a.buyAndRent}]},a.myChartObject.options={title:"Buy vs Rent vs Buy & Rent-out",animation:{duration:3e3,easing:"out"}},a.submit={},a.submit.followup=!0}]),chickAppAdmin.factory("AdminService",["$http",function(a){var b={},c=function(c){a.put("/defaults/"+b.defaults._id,c).then(function(){console.log(c)})},d=function(b){console.log("deleteTheContact deleteID: ",b),a.put("/submit/delete/:id",b).then(function(){getContacts()})},e=function(b){a.put("/submit/statusChange/:id",b).then(function(){getContacts()})},f=function(b){a.put("/submit/statusChangeBack/:id",b).then(function(){getContacts()})};return{admin:b,alterDefaults:c,deleteTheContact:d,updateTheContact:e,updateTheContactBack:f}}]),chickApp.factory("ClientService",["$http",function(a){var b={},c=function(b){a.put("/defaults/"+b._id,b).then(function(){d()})},d=function(){a.get("/defaults").then(function(a){b.defaults=a.data[0]})},e=function(b){a.post("/submit",b).then(function(a){console.log("this was the response from the service submitemail",a)})},f={monthlyRentTenantDef:1290,monthlyRentTenantMin:100,monthlyRentTenantMax:1e4,monthlyRentPersonalDef:800,monthlyRentPersonalMin:200,monthlyRentPersonalMax:1e4,targetPriceDef:266e3,targetPriceMin:5e4,targetPriceMax:5e6,downPaymentPercentageDef:3,downPaymentPercentageMin:0,downPaymentPercentageMax:100,mortgageRateDef:4.25,mortgageRateMin:0,mortgageRateMax:20,yearsAmmoritizedDef:10,yearsAmmoritizedMin:0,yearsAmmoritizedMax:100,incomeDef:8e4,incomeMin:1e4,incomeMax:1e6,mortgageYearsDef:30,mortgageYearsMin:0,mortgageYearsMax:100,vacancyDef:5,vacancyMin:0,vacancyMax:100,propertyTaxDef:1500,propertyTaxMin:0,propertyTaxMax:1e4,assocDuesDef:0,assocDuesMin:0,assocDuesMax:1e4,managementDef:0,managementMin:0,managementMax:1e4,miscDef:1e3,miscMin:0,miscMax:1e5,insuranceAnnualDef:1e3,insuranceAnnualMin:0,insuranceAnnualMax:1e4,utilsDef:100,utilsMin:0,utilsMax:1e4,legalAccountingDef:100,legalAccountingMin:0,legalAccountingMax:1e4,taxBracketDef:28,taxBracketMin:39.9,taxBracketMax:0,repairValueDef:1400,repairValueMin:0,repairValueMax:1e5,yearsDef:5,yearsMin:0,yearsMax:100,zipCode:50466,renterInsuranceDef:50,renterInsuranceMin:0,renterInsuranceMax:4e3,appreciationRateDef:4,appreciationRateMin:0,appreciationRateMax:100},g=function(){a.get("/checkDB").then(function(b){var c=b.data;c===!1?a.post("/defaults",f).then(function(a){d()}):d()})};return g(),{alterDefaults:c,client:b,getDefaults:d,submitEmail:e}}]);